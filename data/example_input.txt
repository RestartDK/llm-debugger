[Code Chunk]  
File: llm-debugger/mcp/main.py  
  
Changed:  
@app.get("/sse")  
async def sse_endpoint(request: Request):  
    """SSE endpoint for MCP protocol over HTTP."""  
    return await sse_endpoint_handler(request)  
  
To:  
@app.get("/sse")  
async def sse_endpoint(request: Request):  
    """SSE endpoint for MCP protocol over HTTP (GET for SSE stream)."""  
    return await sse_endpoint_handler(request)  
  
  
@app.post("/sse")  
async def sse_post_endpoint(request: Request):  
    """Handle POST requests to /sse endpoint (Cursor may POST here for messages)."""  
    # Forward POST requests to the message handler  
    return await sse_message_handler(request, mcp_instance=mcp)  
  
[Explanation]  
Fixed the MCP server connection issue by adding a POST handler to the /sse endpoint. Cursor was attempting to POST messages directly to /sse but was receiving 405 Method Not Allowed errors because only GET was supported. The new POST handler forwards requests to the existing message handler, allowing Cursor to properly connect and communicate with the MCP server via SSE transport. This enables Cursor to initialize the MCP connection, discover tools, and make tool calls successfully.  
  
[Relationships]  
This change relates to:  
- core/mcp_routes.py: The sse_message_handler function processes the forwarded POST requests and handles MCP protocol messages  
- Cursor MCP client: Cursor's SSE transport implementation expects to POST to the SSE endpoint directly, not just to /sse/message  
- FastAPI routing: Adds POST method support alongside existing GET handler for the same endpoint, following RESTful conventions  
- MCP protocol: Enables proper bidirectional communication for SSE-based MCP transport, allowing Cursor to send initialize, tools/list, and tools/call requests  
- main.py structure: Maintains separation between SSE stream (GET) and message handling (POST) while supporting Cursor's expected behavior#   
